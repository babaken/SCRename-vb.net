# SCRename-vb.net

## 概要
VBSが廃止されるらしいのでSCRenameをVB.NETにマイグレーションした。
※本当はC#にマイグレーションしたかったけど面倒なのでここで止める。

## ビルド環境
* Visual Studio 2022
* .NET Framework 4.8

## 手法
1. ChatGPT、Microsoft CopolotからVBS→VB.NETにざっくり変換するプログラムを作成
2. Visual Studio 2022でソリューションを作成してソースぶっこむ
3. あとは手直し

## 追加対応分
・SyobocalのユーザをXMLで指定できるように修正

## マイグレーション元のReadmeより

[概要]

ファイル名を元に、「しょぼいカレンダー」（http://cal.syoboi.jp/）からタイトル、
話数、サブタイトル、日時を取得して自動でリネームを行うプログラムです。
基本的に EpgDataCap_Bon や TvRock との連携を想定していますが、ファイル名を規則
通りにつけることができればどのプログラムからでも利用できます。


[設定]

<EpgDataCap_Bon>

1. SCRename.vbs SCRename.srv SCRename.rp1 SCRename.rp2 SCRename.exc
   SCRenameEDCB.bat を同じフォルダ（例: C:\SCRename）にインストールする。
2. SCRename.srv を編集する（詳細は下記。関東、中京、近畿エリアのデータはある程
   度入力済み。）
3. SCRenameEDCB.bat の「set SCRPATH=」の部分に SCRename.vbs をインストールした
   パスを設定する。（例: set SCRPATH=C:\SCRename）
4. EpgTimer_Bon の「予約録画時のファイル名にマクロを使用する」の設定で
   「$SDYYYY$$SDMM$$SDDD$$STHH$$STMM$_$Title2$ _$ServiceName$.ts」にする。
   （$Title2$ の後に半角空白の挿入を推奨。）
5. EpgTimer_Bon の「録画後実行bat」の設定で
   「"C:\SCRename\SCRenameEDCB.bat"」
   にする。

ほとんどの環境では上記の設定で問題ないはずです。付属のバッチファイルではリネー
ム後のファイルのフルパスが環境変数 SCRTARGET に設定されますので、これを参照す
ることで後の処理につなげることができます。

<TvRock>

EpgDataCap_Bon の場合との相違点は下記の通りです。

1. SCRename.vbs SCRename.srv SCRename.rp1 SCRename.rp2 SCRename.exc
   SCRenameTvRock.bat を同じフォルダ（例: C:\SCRename）にインストールする。
2. TvRock が出力する局名に合わせて SCRename.srv を編集する。
3. TvRock の「ファイル名置換フォーマット」の設定で「@YY@MM@DD@SH@SM_@TT _@CH」
   にする。（@TT の後に半角空白の挿入を推奨。）
4. TvRock の「コマンドを実行する」の設定で
   「TN:"C:\SCRename\SCRenameTvRock.bat" "%1"」
    にするか、または
   「TN:"cscript //nologo C:\SCRename\SCRename.vbs" "%1" "$SCtitle$ $SCpart$第$SCnumber$話 「$SCsubtitle$」 ($SCservice$)"」
    にする。


[ファイル構成]

SCRename.vbs:
プログラム本体。CScript で実行して下さい。

SCRename.bat:
SCRename.vbs 起動用バッチファイル。
リネームを行いたいファイルを直接ドラッグ＆ドロップして使用します。複数のファイ
ルを一度に処理することも可能です。
動作としては、SCRename.vbs でリネームを行い、リネーム後のファイルのフルパスを環
境変数 SCRTARGET に設定するようになっています。

SCRenameEDCB.bat:
EpgTimer_Bon 用バッチファイル。
上記 SCRename.bat と同内容ですが、EpgTimer_Bon の「録画後実行bat」に登録して使
用します。あらかじめ「set SCRPATH=」の部分を変更しておく必要があります。
「SCRenameEDCB.bat "$FilePath$" 0 8」のようにパラメータ（後述）を指定することも
可能です。

SCRenameTvRock.bat:
TvRock 用バッチファイル。
上記のバッチファイルと同内容です。TvRock の「コマンドを実行する」に登録して使用
します。
「SCRenameTvRock.bat "%1" 0 8」のようにパラメータ（後述）を指定することも可能で
す。

SCRename.exc:
リネーム対象外定義ファイル。
リネームを行いたくないファイルがある場合に使用します。各行に記載された文字列の
いずれかがファイル名に含まれる場合はリネームを行いません。
なお、先頭が : で始まる行は無視されます。

SCRename.rp1:
リネーム前置換用定義ファイル。
元のファイル名ではしょぼいカレンダーの検索が行えない場合に、内部的にファイル名
の一部を置換してから検索を行うための定義ファイルです。
1列目は置換元の文字列、2列目は置換先の文字列です。置換処理は上記の半角変換の前
に行われます。文字コードは Shift_JIS もしくは UTF-16 を使用可能です。内容を適宜
編集してプログラム本体と同じフォルダに入れて下さい。
なお、先頭が : で始まる行は無視されます。

SCRename.rp2:
リネーム後置換用定義ファイル。
上記と同様の置換用定義ファイルですが、こちらはしょぼいカレンダーから取得した番
組情報に対して置換を行う必要がある場合に使用します。ファイルのリネームの直前に
このファイルの内容を取得して置換されます。
なお、先頭が : で始まる行は無視されます。

SCRename.srv:
検索およびリネーム用の放送局名定義ファイル。
1列目は EpgTimer_Bon もしくは TvRock によって記録されるサービス名、2列目はしょ
ぼいカレンダー上の放送局名、3列目はリネームの際に使用される名前（放送局の略称な
ど）、4列目はしょぼいカレンダーの ChID にします。
このプログラムではファイル名の全角英数字を内部で半角にしていますので、1列目のサ
ービス名の英数字は半角である必要があります。文字コードはShift_JIS もしくは
UTF-16 を使用可能です。内容を適宜編集してプログラム本体と同じフォルダに入れて下
さい。
なお、先頭が : で始まる行は無視されます。

SCRename.tid:
TID のキャッシュファイル。
話数検索を行う際に自動で作成されます。適宜編集して使用することもできます。


[使用方法]

コマンドプロンプトもしくはバッチファイルで下記のように実行します。

cscript //nologo SCRename.vbs [オプション] "ファイル" "リネーム書式" [番組名開始位置] [検索文字数]

<オプション>

下記のオプションを使用可能です。

-a	話数検索を有効にします。
-a1	通常の検索を省略して話数検索のみを行います。
-f	強制リネームを行います。
-h,-?	ヘルプを表示します。
-n	サブタイトルを取得できない場合に処理を中止します。
-t	フォルダ作成およびリネームを行いません。
-s	不要な空白の削除を行いません。

<ファイル>

リネームを行うファイルのフルパスを指定します。
ファイル名は下記の書式に従うことを推奨します。

YYYYMMDDhhmm_番組名 _放送局名.拡張子

「_」を各項目の区切り文字としており、各項目は上記と厳密に同じ順番でなくても動作
します。
「YYYYMMDDhhmm」は日時を想定しており、「年月日時分」となります。検索はこの日付
の前日から2日間を対象にします。また省略することも可能で、その場合はファイルの作
成日もしくは更新日のどちらか古い方から遡って一週間を検索します。
「番組名」および「放送局名」の部分について、全角空白、全角英数字および
：；／’”－ はプログラム内部で半角に変換されます。また、ローマ数字も対応する半
角英字に変換されます。ただし、これらは検索のための一時的な処理であり、直ちにリ
ネームが行われるわけではありません。
「放送局名」は SCRename.srv の1列目と対応させる必要がありますが、部分一致で検索
を行うため SCRename.srv には「放送局名」の一部が記載されていれば問題ありませ
ん。
しょぼいカレンダーの検索も部分一致で行います。そのため、「番組名」および
SCRename.srv の2列目も完全な名前である必要はありません。
「拡張子」は任意で、リネーム後のファイル名に引き継がれます。

<リネーム書式>

リネームを行う際の書式を指定します。使用できる書式は下記の通りです。

\			フォルダ名の区切りとして扱われます。
$SCtitle$		タイトルに置換されます。
$SCtitle2$		『』 以外の括弧でくくられた部分を除いたタイトルに置換されます。
$SCpart$		「前編」などに置換されます。
$SCnumber$		話数（2桁以上）に置換されます。
$SCnumber1$		話数（1桁以上）に置換されます。
$SCnumber2$		$SCnumber$と同じです。
$SCnumber3$		話数（3桁以上）に置換されます。
$SCnumber4$		話数（4桁以上）に置換されます。
$SCsubtitle$		サブタイトルに置換されます。
$SCservice$		放送局名（SCRename.srv の3列目）に置換されます。
$SCdate$		放送開始年月日（YYMMDD）に置換されます。
$SCdate2$		放送開始年月日（YYYYMMDD）に置換されます。
$SCyear$		放送開始年（2桁）に置換されます。
$SCyear2$		放送開始年（4桁）に置換されます。
$SCmonth$		放送開始月（2桁）に置換されます。
$SCday$			放送開始日（2桁）に置換されます。
$SCquarter$		放送開始クォーターに置換されます。
$SCweek$		放送開始曜日に置換されます。
$SCweek2$		放送開始曜日（英語）に置換されます。
$SCweek3$		放送開始曜日（大文字英語）に置換されます。
$SCtime$		放送開始時刻（hhmm）に置換されます。
$SCtime2$		放送開始時刻（hhmmss）に置換されます。
$SChour$		放送開始時（2桁）に置換されます。
$SCminute$		放送開始分（2桁）に置換されます。
$SCsecond$		放送開始秒（2桁）に置換されます。
$SCeddate$		放送終了年月日（YYMMDD）に置換されます。
$SCeddate2$		放送終了年月日（YYYYMMDD）に置換されます。
$SCedyear$		放送終了年（2桁）に置換されます。
$SCedyear2$		放送終了年（4桁）に置換されます。
$SCedmonth$		放送終了月（2桁）に置換されます。
$SCedday$		放送終了日（2桁）に置換されます。
$SCedquarter$		放送終了クォーターに置換されます。
$SCedweek$		放送終了曜日に置換されます。
$SCedweek2$		放送終了曜日（英語）に置換されます。
$SCedweek3$		放送終了曜日（大文字英語）に置換されます。
$SCedtime$		放送終了時刻（hhmm）に置換されます。
$SCedtime2$		放送終了時刻（hhmmss）に置換されます。
$SCedhour$		放送終了時（2桁）に置換されます。
$SCedminute$		放送終了分（2桁）に置換されます。
$SCedsecond$		放送終了秒（2桁）に置換されます。

－28時制表記（[仕様詳細]参照）－
$SCdates$		放送開始年月日（YYMMDD）に置換されます。
$SCdate2s$		放送開始年月日（YYYYMMDD）に置換されます。
$SCyears$		放送開始年（2桁）に置換されます。
$SCyear2s$		放送開始年（4桁）に置換されます。
$SCmonths$		放送開始月（2桁）に置換されます。
$SCdays$		放送開始日（2桁）に置換されます。
$SCquarters$		放送開始クォーターに置換されます。
$SCweeks$		放送開始曜日に置換されます。
$SCweek2s$		放送開始曜日（英語）に置換されます。
$SCweek3s$		放送開始曜日（大文字英語）に置換されます。
$SCtimes$		放送開始時刻（hhmm）に置換されます。
$SCtime2s$		放送開始時刻（hhmmss）に置換されます。
$SChours$		放送開始時（2桁）に置換されます。
$SCeddates$		放送終了年月日（YYMMDD）に置換されます。
$SCeddate2s$		放送終了年月日（YYYYMMDD）に置換されます。
$SCedyears$		放送終了年（2桁）に置換されます。
$SCedyear2s$		放送終了年（4桁）に置換されます。
$SCedmonths$		放送終了月（2桁）に置換されます。
$SCeddays$		放送終了日（2桁）に置換されます。
$SCedquarters$		放送終了クォーターに置換されます。
$SCedweeks$		放送終了曜日に置換されます。
$SCedweek2s$		放送終了曜日（英語）に置換されます。
$SCedweek3s$		放送終了曜日（大文字英語）に置換されます。
$SCedtimes$		放送終了時刻（hhmm）に置換されます。
$SCedtime2s$		放送終了時刻（hhmmss）に置換されます。
$SCedhours$		放送終了時（2桁）に置換されます。

リネーム書式に \ が含まれており、対応するフォルダが存在しない場合は、フォルダを
作成後にファイルの移動およびリネームを行います。この際、相対パスとして指定した
場合はリネーム元のフォルダが基準になります。
リネーム後のフルパスが256文字以上になる場合は、拡張子を保持しながら255文字に切
り詰めます。
$SCpart$ と $SCnumber$～$SCnumber3$ のどちらかは必ず空になるため、同時に使用す
ることを推奨します。

<番組名開始位置>
<検索文字数>

ファイル名の先頭を 1 として、「番組名開始位置」から「検索文字数」の分だけを番組
名の検索に用いるための文字列として取得します。「番組名開始位置」に 0 を指定した
場合は自動で設定されます。
また、「番組名開始位置」に空白、()[]（）〔〕［］｛｝〈〉《》「」【】＜＞ でくく
られた部分もしくは :;/'"-_：；／’”－!？！～…『』・ のいずれかがある場合は、
それらすべてを除外して「検索文字数」の分を取得します。
「番組名開始位置」を省略した場合は 0、「検索文字数」を省略した場合は 4 として処
理されますが、「番組名」の文字数が「検索文字数」に満たない場合は適宜縮小されま
す。また、検索文字列に空白もしくは
_!？！～…『』()[]（）〔〕［］｛｝〈〉《》「」【】＜＞ のいずれかを含む場合はこ
れらの文字の前までを取得します。

（例1）
cscript SCRename.vbs "201002210230_とある科学の超電磁砲_ ｔｖｋ１.mp4" "$SCtitle$ $SCpart$第$SCnumber$話 「$SCsubtitle$」 ($SCservice$ 1280x720 24fps x264 AAC)"

期間:		2010年2月20日から2日間
番組名:		とある科
放送局名:	tvk
として検索され、以下の様にリネームが行われます。

とある科学の超電磁砲 第20話 「乱雑開放(ポルターガイスト)」 (tvk 1280x720 24fps x264 AAC).mp4

（例2）（ファイル更新日 2009年6月1日）
cscript SCRename.vbs "D:\TS\Ｐｈａｎｔｏｍ～Requiem for the Phantom～_ テレビ東京１.ts.program.txt" "$SCyear$$SCmonth$$SCday$$SCtime$-$SCtitle$ 第$SCnumber1$話 『$SCsubtitle$』 (D-$SCservice$)" 2 5

期間:		2009年6月1日から遡って1週間
番組名:		hanto
放送局名:	テレビ東京
として検索され、以下の様にリネームが行われます。

D:\TS\0905290215-Phantom～Requiem for the Phantom～ 第9話 『名前』 (D-TX).ts.program.txt

（例3）
cscript SCRename.vbs "ＫＩＤＤＹ　ＧｉＲＬ－ＡＮＤ_ tvk1_200910240315.ts" "[$SCmonths$月$SCday$日($SCweeks$) $SChours$時$SCminutes$分-$SCedhours$時$SCedminutes$分] $SCtitle$ 第$SCnumber4$話 「$SCsubtitle$」 ($SCservice$ PT2)"

期間:		2009年10月23日から2日間
番組名:		キディ
放送局名:	tvk
として検索され（SCRename.rp1 参照）、以下の様にリネームが行われます。

[10月23日(金) 27時15分-27時45分] キディ・ガーランド 第0002話 「甘い、罠」 (tvk PT2).ts

（例4）
cscript SCRename.vbs "c:\audio\200910250100_まほろまてぃっく特別編「後編」_ BS-TBS.wav" "$SCtitle$ $SCpart$第$SCnumber$話 「$SCsubtitle$」 ($SCservice$) [$SCdate$]" 15

期間:		2009年10月24日から2日間
番組名:		ほろまて
放送局名:	BS-TBS
として検索され（SCRename.rp2 参照）、以下の様にリネームが行われます。

まほろまてぃっく特別編 ただいま◆おかえり 後編 「おかえりの空」 (BS-TBS) [091025].wav

（例5）
cscript SCRename.vbs "201001150045_[新]＜ノイタミナ＞のだめカンタービレ　フィナーレ　＃０１_ フジテレビ.aac" "$SCyear2$Q$SCquarter$ $SCtitle$ 第$SCnumber$話 $SCtime$-$SCedtime$"

期間:		2010年1月14日から2日間
番組名:		のだめカ
放送局名:	フジテレビ
として検索され、以下の様にリネームが行われます。

2010Q1 のだめカンタービレ フィナーレ 第01話 0045-0115.aac

（例6）
cscript SCRename.vbs "[1004240700] 未来少年コナン.txt" "$SCtitle$ $SCpart$第$SCnumber$話 「$SCsubtitle$」 ($SCservice$)[$SCdate2$($SCweek2$)-$SCtime2$]"

期間:		2010年4月23日から2日間
番組名:		未来少年
放送局名:	すべて
として検索され、以下の様にリネームが行われます。

未来少年コナン 第07,08話 「追跡 ／ 逃亡」 (SUN)[20100424(Sat)-070000].txt

（例7）
cscript SCRename.vbs "D:\TS\201101111730_神のみぞ知るセカイ _テレビ愛知.ts" "$SCtitle$\$SCpart$第$SCnumber$話\「$SCsubtitle$」($SCservice$)"

期間:		2011年1月10日から2日間
番組名:		神のみぞ
放送局名:	テレビ愛知
として検索され、以下の様に移動およびリネームが行われます。

D:\TS\神のみぞ知るセカイ\第02話\「あくまでも妹です／ベイビー・ユー・アー・ア・リッチ・ガール」(TVA).ts


[話数検索]

オプション -a を使用することによって、通常の方法で番組情報を取得できない場合に
ファイル名からタイトルと話数を取得して検索を行うことができます。なお、オプショ
ン -a1 を使用した場合には、通常の検索処理を省略して話数検索を行います。

話数検索を行う場合、ファイル名は下記の書式に従う必要があります。

番組名_#x_放送局名.拡張子
または
番組名_第x話_放送局名.拡張子

「x」は半角数字で、話数を指定します。各項目の区切りは _ の代わりに空白を使用す
ることも可能です。「番組名」は前方一致で検索を行い、「放送局名」は省略すること
も可能です。

話数検索ではしょぼいカレンダーで使用される TID の取得を行いますが、一度取得した
TID は SCRename.tid にキャッシュされます。もし、TID の取得において期待通りの動
作をしない場合は SCRename.tid を適宜編集して下さい。


[仕様詳細]

<空白削除>

フォルダ名やファイル名の前後の空白、および連続した空白は削除されます。
なお、この機能はオプションで抑制することができます。

<強制リネーム>

強制リネームオプションである -f を使用することによって、しょぼいカレンダーから
番組情報を取得できない場合でもリネームを行うことができます。
この際、タイトル、サブタイトル、放送局名はファイル名から取得し、サブタイトルは
「」 でくくられた部分になります。放送開始と終了日時はファイル名もしくはファイル
の作成または更新日時から取得します。
通常、$SCtitle$ $SCtitle2$ は同じ内容に置換されますが、強制リネームオプションを
使用し、かつ、しょぼいカレンダーから番組情報を取得できない場合のみ、$SCtitle2$
は 『』 以外の括弧でくくられた部分を除いたタイトルに置換されます。

<時刻表記>

日時に関するリネーム書式の最後尾の $ の直前に s を入れることで、しょぼいカレン
ダーと同様である28時制表記を行います。
具体的には、午前4時台以前を前日の時刻で表記します。
（例: 10月24日3時15分→10月23日27時15分）

<終了処理>

リネームを行った場合は、リネーム後のフルパスを標準出力に出力し、エラーコードと
して 0 を返します。
リネームを行わなかった場合は、リネーム元のフルパスを標準出力に出力し、エラーコ
ードとして 1 を返します。
なお、メッセージ等は標準エラー出力に出力しています。

<処理順序>

リネーム元のファイル名を取得後、下記の順序で処理を行います。

 1. ファイル名から日時取得。
 2. ファイル名から日時が取得できない場合はファイルの作成日時もしくは更新日時か
    ら取得。
 3. 起動時のパラーメータ「番組名開始位置」の前までを削除。
 4. SCRename.rp1 の内容で置換。
 5. 先頭に空白、『』 以外の括弧でくくられた部分、もしくは
    :;/'"-_：；／’”－!？！～…『』・ がある場合は削除。
 6. 5. を繰り返す。
 7. 全角の空白と英数字および ：；／’”－ を半角に、ローマ数字を半角英字に変
    換。
 8. 「検索文字数」の分もしくは、空白、各種括弧および _!？！～… の前までを番
    組名検索文字列として取得。
 9. 放送局名取得。
10. しょぼいカレンダーの番組情報を取得して検索。
11. SCRename.rp2 の内容で置換。
12. ファイル名に使用できない文字を全角に変換。
13. 不要な空白を削除。
14. ファイルパスを255文字に切り詰め。
15. フォルダを作成。
16. 元ファイルの移動およびリネーム。


[注意点]

SCRename.srv は先に記載されたものから順に検索されます。したがって、「BS-TBS」
「TBS」の様に同じ文字列を含む場合はより長い名前の方を先に記載してください。

SCRename.rp1 SCRename.rp2 SCRename.exc も同様に先に記載されたものから順に置換さ
れます。この際、すべての行について処理を行うため、二重に置換されることがあり得
ます。これを防ぐためになるべく長い文字列を記載して下さい。

Microsoft XML パーサーがインストールされている必要があります。

起動されてから90秒以内に処理が完了しない場合は中止します。


[不具合・要望等]

2ちゃんねる「TS関連ソフトウェア総合スレ」へ。


[改変履歴]

Ver. 6.2
	拡張子を除いたファイル名の最後が話数で終わっている場合に話数検索が正しく行われないことがある問題を修正した。

Ver. 6.1
	一回の放送に複数話が含まれている場合に $SCnumber1$ のリネームが正しく行われない問題を修正した。
	その他軽微な変更を行った。

Ver. 6.0
	話数検索の機能を追加した。
	その他軽微な変更を行った。

Ver. 5.1
	一回の放送に複数話が含まれ、かつ、サブタイトルが登録されていない場合に無限ループする問題を修正した。
	その他軽微な変更を行った。

Ver. 5.0
	Windows の「日付と時刻の形式」の設定によっては動作しない問題を修正した。
	時刻表記のリネーム書式を追加した。
	その他軽微な変更を行った。

Ver. 4.8
	各定義ファイルにおいて、先頭が : で始まる行を無視するようにした。
	強制リネーム時に日時のリネームが正しく行われない問題を修正した。
	タイトルと曜日に関するリネーム書式を追加した。
	不要な空白を削除するようにした。
	オプションの追加・変更を行った。
	その他軽微な変更を行った。

Ver. 4.7a by 726氏
	一回の放送に複数話が含まれる場合の話数とサブタイトルの取得方法を変更した。

Ver. 4.7
	しょぼいカレンダーのデフォルトの放送局以外の番組情報を取得できない問題を修正した。
	しょぼいカレンダーの検索の際に放送局名の大文字・小文字を区別しないようにした。
	その他軽微な変更を行った。

Ver. 4.6
	強制リネーム時に全角英数字等を半角に変換するようにした。

Ver. 4.5
	しょぼいカレンダーの検索の際に番組名と放送局名の大文字・小文字を区別しないようにした。
	強制リネームの機能を追加した。
	フォルダの存在判定処理を修正した。
	番組情報の取得処理を変更した。
	その他軽微な変更を行った。

Ver. 4.4
	リネーム後のフルパスが 256 文字以上になる場合は 255 文字に切り詰めるようにした。
	その他軽微な修正を行った。

Ver. 4.3
	番組情報に "<> が含まれている場合にリネームが正しく行われない問題を修正した。
	フォルダ分けのためのリネーム書式を変更した。
	その他軽微な修正を行った。

Ver. 4.2a by 愛用者の一人
	リネーム書式に \ および \\ を使用することにより、フォルダ分けを行えるようにした。

Ver. 4.2
	サブタイトルが取得できない場合にリネームを行わないオプションを追加した。
	番組情報に &' が含まれているとリネームが正しく行われない問題を修正した。
	XMLHttpRequest オブジェクトの作成をリトライするようにした。
	処理を中断するまでの時間を90秒にした。
	その他軽微な変更を行った。

Ver. 4.1
	「検索文字数」のデフォルトを「4」にした。
	処理を中断するまでの時間を60秒にした。
	拡張子の取得処理を変更した。

Ver. 4.0
	しょぼいカレンダーへのアクセスに XMLHttpRequest を使用するようにした。
	SCRename.bat SCRenameEDCB.bat SCRenameTvRock.bat を変更した。
	リネーム対象外定義ファイルの拡張子を変更した。
	放送局名定義ファイルの拡張子を変更した。
	処理を中断するまでの時間を30秒にした。
	リネーム書式を変更した。
	話数の処理を変更した。
	その他軽微な修正を行った。

Ver. 3.1
	ファイル名から日時が取得できない場合にファイルの作成日時と更新日時を参照するようにした。
	番組情報の検索時に番組開始もしくは終了時刻を参照するようにした。
	リネーム対象外のファイル名を指定できるようにした。
	起動時のパラメータにオプションを追加した。
	処理を中断するまでの時間を60秒にした。
	クォーターの計算の誤りを修正した。
	放送局名定義ファイルを変更した。
	その他軽微な修正を行った。

Ver. 3.0
	番組名として検索する文字列の先頭に括弧でくくられた部分がある場合は無視するようにした。
	ファイル名から日付が取得できない場合にファイルの作成日を参照するようにした。
	ファイル名からの日付、番組名、放送局名の取得処理を変更した。
	起動時のパラメータの処理を変更した。
	エラー表示にウェイトを入れた。
	その他軽微な修正を行った。

Ver. 2.4
	Internet Explorer の起動をリトライするようにした。
	区切り文字に ／ を追加した。
	リネーム書式を追加した。
	その他軽微な変更を行った。

Ver. 2.3
	ファイル名からの放送局名の取得処理を変更した。

Ver. 2.2
	番組名に放送局名が含まれている場合に放送局名を正しく取得できない問題を修正した。

Ver. 2.1
	定義ファイルの文字コードとして Shift_JIS と UTF-16 を使用可能にした。
	リネームを行う際の書式として放送年・月・日を個別に指定可能にした。
	その他軽微な変更を行った。

Ver. 2.0
	番組名として検索する文字列の先頭が空白もしくは [_？！～…・（〔［｛〈《「『【＜ の場合は無視するようにした。
	ファイル名置換用定義ファイルを SCRename.rep から SCRename.rp1 に変更した。
	リネーム処理の直前で SCRename.rp2 の内容を元に置換を行うようにした。
	Internet Explorer の起動をリトライしないようにした。
	起動から2分経過した場合は処理を中断するようにした。
	日時が拡張子の直前にあっても動作するようにした。
	その他軽微な変更を行った。

Ver. 1.6
	Internet Explorer の起動およびしょぼいカレンダーへのアクセスをリトライするようにした。
	SCRename.bat へ同時に複数のファイルをドラッグ＆ドロップして処理できるようにした。
	その他軽微な変更を行った。

Ver. 1.5
	ファイル名にローマ数字が含まれている場合に内部で半角英字に変換するようにした。
	ファイル名からの番組名の取得処理を変更した。
	TvRock 用のバッチファイルを同梱した。

Ver. 1.4
	しょぼいカレンダーに話数、サブタイトルの情報がない場合でも正しく動作するようにした。
	その他軽微な修正を行った。

Ver. 1.3
	英語版の Internet Explorer がインストールされていても正常に動作するようにした。
	リネーム元のファイルが存在しない場合にエラーメッセージを表示するようにした。
	ウェイトを減らした。
	その他軽微な変更を行った。

Ver. 1.2
	ウェイトを減らした。

Ver. 1.1
	Internet Explorer の起動失敗時にエラーメッセージを表示するようにした。
	しょぼいカレンダーへのアクセス要求後のウェイトを増やした。

Ver. 1.0
	初版。


